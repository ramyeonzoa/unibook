# Day 6 과목 선택 시스템 테스트 체크리스트

## 🎯 테스트 목표
**과목 선택 시스템이 정상적으로 작동하는지 확인**
- 교수 검색 → 과목 선택 → SubjectBook 자동 연결 전체 플로우 검증

---

## 📋 사전 준비 사항

### 1. 서버 실행 확인
- [ ] MySQL 서버 실행 중 (localhost:3306)
- [ ] IntelliJ에서 UnibookApplication 실행
- [ ] `http://localhost:8080` 접속 가능
- [ ] 콘솔에 오류 없음

### 2. 로그인 상태 확인
- [ ] 이메일 인증된 사용자로 로그인
- [ ] 게시글 작성 권한 있음 (`/posts/new` 접근 가능)

---

## 🔍 핵심 기능 테스트

### A. 게시글 작성 폼 진입
- [ ] `/posts/new` 접속
- [ ] 폼이 정상적으로 로드됨
- [ ] 상품 유형 선택 드롭다운 존재
- [ ] 책 선택 div가 숨겨져 있음 (`display: none`)
- [ ] 과목 선택 div가 숨겨져 있음 (`display: none`)

### B. 상품 유형별 UI 표시/숨김
#### B-1. TEXTBOOK 선택 시
- [ ] 상품 유형에서 "전공교재" 선택
- [ ] 책 선택 div가 표시됨 (`#bookSelectDiv`)
- [ ] 과목 선택 div가 표시됨 (`#subjectSelectDiv`)
- [ ] "책 검색하기" 버튼 존재
- [ ] "과목 선택하기" 버튼 존재

#### B-2. CERTBOOK 선택 시
- [ ] 상품 유형에서 "자격증 교재" 선택
- [ ] 책 선택 div가 표시됨
- [ ] 과목 선택 div가 표시됨
- [ ] 두 버튼 모두 존재

#### B-3. 기타 타입 선택 시
- [ ] "필기노트", "족보/기출", "기타" 선택
- [ ] 책 선택 div가 숨겨짐
- [ ] 과목 선택 div가 숨겨짐
- [ ] `bookId`, `subjectId` 값이 초기화됨

### C. 책 검색 기능 (기존 기능 유지 확인)
- [ ] "책 검색하기" 버튼 클릭
- [ ] 책 검색 모달 열림
- [ ] 네이버 API 검색 정상 작동
- [ ] 책 선택 시 정보 표시됨
- [ ] 모달 닫기 정상 작동

### D. 과목 선택 기능 (신규 기능)
#### D-1. 과목 선택 모달 열기
- [ ] "과목 선택하기" 버튼 클릭
- [ ] 과목 선택 모달 열림 (`#subjectSearchModal`)
- [ ] 3단계 표시 UI 존재 (교수 검색 → 과목 선택 → 확인)
- [ ] 1단계가 활성화 상태
- [ ] 2, 3단계는 비활성화 상태

#### D-2. 1단계: 교수 검색
- [ ] 교수명 입력 필드 존재 (`#professorSearchInput`)
- [ ] "검색" 버튼 클릭 가능
- [ ] 빈 값으로 검색 시 alert 표시
- [ ] 유효한 교수명 입력 후 검색
- [ ] 로딩 스피너 표시
- [ ] 검색 결과 목록 표시 (교수명, 학과명)
- [ ] 교수 선택 시 2단계 활성화
- [ ] 선택된 교수 정보 표시

#### D-3. 2단계: 과목 검색/생성
- [ ] 과목 검색 입력 필드 활성화 (`#subjectSearchInput`)
- [ ] 과목명 입력 후 검색
- [ ] 기존 과목 있을 경우: 목록 표시
- [ ] 기존 과목 없을 경우: "새 과목 생성" 버튼 표시
- [ ] 과목 선택 시 3단계 활성화
- [ ] 새 과목 생성 시 정상 처리

#### D-4. 3단계: 선택 확인
- [ ] 선택된 과목 정보 카드 표시
- [ ] 교수명, 학과명, 과목명, 타입 정보 표시
- [ ] "선택 완료" 버튼 활성화
- [ ] "선택 완료" 클릭 시 모달 닫힘
- [ ] 메인 폼에 선택된 과목 정보 표시
- [ ] "제거" 버튼으로 선택 취소 가능

---

## 🔄 통합 시나리오 테스트

### 시나리오 1: 완전한 플로우 (책 + 과목 모두 선택)
1. [ ] TEXTBOOK 선택
2. [ ] 책 검색으로 교재 선택
3. [ ] 과목 선택으로 교수/과목 연결
4. [ ] 제목, 가격, 설명 입력
5. [ ] 게시글 등록 버튼 클릭
6. [ ] 성공적으로 등록됨
7. [ ] 게시글 상세 페이지에서 책 정보 표시 확인

### 시나리오 2: 책만 선택 (과목 선택 안 함)
1. [ ] TEXTBOOK 선택
2. [ ] 책 검색으로 교재 선택
3. [ ] 과목 선택하지 않음 (`subjectId` = null)
4. [ ] 나머지 정보 입력 후 등록
5. [ ] 정상 등록됨 (과목 없이도 가능)

### 시나리오 3: 자격증 교재 (CERTBOOK)
1. [ ] CERTBOOK 선택
2. [ ] 자격증 관련 책 검색/선택
3. [ ] 과목 선택 (자격증 관련 과목)
4. [ ] 정상 등록됨

### 시나리오 4: 교재가 아닌 타입
1. [ ] NOTE, PASTEXAM, ETC 선택
2. [ ] 책/과목 선택 UI 숨겨짐
3. [ ] 일반 게시글로 정상 등록됨

---

## 🚨 오류 상황 테스트

### 네트워크/API 오류
- [ ] 교수 검색 API 오류 시 적절한 에러 메시지
- [ ] 과목 검색 API 오류 시 적절한 에러 메시지
- [ ] 과목 생성 실패 시 에러 처리

### 사용자 입력 오류
- [ ] 빈 값으로 교수 검색 시 alert
- [ ] 빈 값으로 과목 검색 시 alert
- [ ] 교수 선택 없이 과목 검색 시 alert

### 데이터 일관성
- [ ] 동일한 교수-과목 조합 중복 생성 방지
- [ ] SubjectBook 테이블에 올바른 데이터 저장
- [ ] 게시글 수정 시에도 과목 정보 유지

---

## 🔧 백엔드 로직 검증

### API 엔드포인트 테스트
- [ ] `GET /api/professors/search?query=교수명` - 교수 검색
- [ ] `GET /api/subjects/search?query=과목명&professorId=123` - 과목 검색
- [ ] `POST /api/subjects/select` - 새 과목 생성

### 데이터베이스 확인
- [ ] `subjects` 테이블에 새 과목 저장됨
- [ ] `subject_books` 테이블에 연결 관계 저장됨
- [ ] `posts` 테이블에 `book_id` 저장됨 (subject_id는 없음)

### 서비스 로직 검증
- [ ] `PostService.handleSubjectBookConnection()` 정상 실행
- [ ] `SubjectBookService.findOrCreateSubjectBookConnection()` 정상 실행
- [ ] 동시성 방어 (`saveAndFlush()`) 작동 확인

---

## 🎨 UI/UX 테스트

### 반응형 디자인
- [ ] 모바일에서 모달 정상 작동
- [ ] 태블릿에서 단계별 UI 표시 확인

### 사용성 테스트
- [ ] 단계별 진행 상태가 명확히 보임
- [ ] 뒤로가기/취소 기능 정상 작동
- [ ] 로딩 상태 표시 적절함
- [ ] 에러 메시지가 사용자 친화적

### 디자인 일관성
- [ ] 책 검색 모달과 과목 선택 모달 스타일 일관성
- [ ] Bootstrap 컴포넌트 올바른 사용
- [ ] 아이콘 일관성 (`bi-book`, `bi-person-workspace`)

---

## ✅ 최종 확인 사항

### 성능
- [ ] 페이지 로딩 속도 적절함
- [ ] API 응답 시간 2초 이내
- [ ] 메모리 누수 없음

### 보안
- [ ] CSRF 토큰 올바르게 전송됨
- [ ] 인증되지 않은 사용자 접근 차단
- [ ] XSS 방어 (`title.replace(/<[^>]*>/g, '')`)

### 로그 확인
- [ ] 콘솔에 JavaScript 오류 없음
- [ ] 서버 로그에 에러 없음
- [ ] 성공적인 SubjectBook 연결 로그 확인

---

## 🐛 알려진 제한사항
1. **페이징**: 교수/과목 검색에서 10개씩만 표시 (페이징 구현됨)
2. **캐싱**: 검색 결과 캐싱 없음 (향후 개선 예정)
3. **검색어 정규화**: 유니코드 정규화 적용됨

---

## 📞 문제 발생 시 체크포인트

### JavaScript 오류
1. 브라우저 개발자 도구 → Console 탭 확인
2. `/js/subject-search.js` 파일 로드 확인
3. CSRF 토큰 설정 확인

### API 오류
1. Network 탭에서 API 호출 상태 확인
2. 서버 로그 확인 (IntelliJ 콘솔)
3. 데이터베이스 연결 상태 확인

### 모달 오류
1. Bootstrap JavaScript 라이브러리 로드 확인
2. `$('#subjectSearchModal').modal('show')` 정상 호출 확인
3. CSS 충돌 확인

---

이 체크리스트를 순서대로 진행하시면 과목 선택 시스템의 모든 기능을 검증할 수 있습니다! 🚀